```c
// Refactored code with clear comments
#include <stdio.h>
#include <stdlib.h>

#define ARRAY_SIZE 1000

typedef long int LongInt;

typedef struct {
    int is_operator;
    LongInt value;
} Expression;

// Function to create an expression struct
Expression create_expression(LongInt value, int is_operator) {
    Expression expr;
    expr.is_operator = is_operator;
    expr.value = value;
    return expr;
}

// Function to compute a unique hash based on character input
int compute_hash(char *input) {
    LongInt hash = 1, shift = 0;
    while (input[shift]) {
        hash >>= 1;
        hash ^= input[shift++];
    }
    return (hash & 15) | (shift ^ *input) << 4 & 240;
}

// Processes each character command and updates the stack
void process_command(int hash, LongInt *n, LongInt *m, LongInt *o, Expression *stack, LongInt *i, LongInt *g) {
    switch (hash) {
        case 16: break;
        case 90: *n = 0; *m += *n * *o * ARRAY_SIZE * ARRAY_SIZE * ARRAY_SIZE; break;
        case 106: *n += 7; break;
        case 52: *n += 40; break;
        case 223: *n += 18; break;
        case 31: *n += 15; break;
        case 165: *n += 9; break;
        case 121: *n += 2; break;
        case 40: *n += 5; break;
        case 113: *n += 10; break;
        case 56: *n += 11; break;
        case 111: *n += 19; break;
        case 45: *n += 12; break;
        case 238: *n += 14; break;
        case 0: *n += 6; break;
        case 47: *n += 4; break;
        case 206: *n += 13; break;
        case 49: *n += 50; break;
        case 55: break;
        case 130: *n += 90; break;
        case 175: *n += 17; break;
        case 2: *n += 8; break;
        case 17: *n += 3; break;
        case 103: *n += 60; break;
        case 202: *n = 0; *m += *n * *o * ARRAY_SIZE * ARRAY_SIZE * ARRAY_SIZE * ARRAY_SIZE; break;
        case 192: *n = 0; *m += *n * *o * ARRAY_SIZE; break;
        case 65: *n += 70; break;
        case 137: *n = 0; break;
        case 110: *o = -1; break;
        case 39: *n += 30; break;
        case 201: *n += 1; break;
        case 242: *n += *n * 99; break;
        case 78: *n += 16; break;
        case 170: *n = 0; *m += *n * *o * ARRAY_SIZE; break;
        case 76: break;
        case 232: break;
        case 48: *n += 80; break;
        case 32: *n += 20; break;
        default: break;
    }
}

// Main function to execute the program
int main(int argc, char **argv) {
    LongInt m = 0, n = 0, o = 1;
    Expression stack[ARRAY_SIZE];
    LongInt i = 0, g = ARRAY_SIZE;

    for (int index = 1; index < argc; index++) {
        char *arg = argv[index];
        int hash = compute_hash(arg);
        process_command(hash, &n, &m, &o, stack, &i, &g);
    }

    // Final calculation and output
    while (g != ARRAY_SIZE) {
        stack[i++] = stack[g++];
    }
    while (g != i) {
        if (stack[g].is_operator) {
            stack[--g] = stack[g++];
        } else {
            n = stack[g++].value;
            o = stack[g++].value;
            m = stack[g++].value;
            stack[--g] = m == 1 ? create_expression(n + o, 1) :
                          m == 2 ? create_expression(o - n, 1) :
                          m == 5 ? create_expression(n * o, 1) :
                          m == 6 ? create_expression(o / n, 1) :
                          create_expression(o % n, 1);
        }
    }

    printf("%ld\n", stack[g].value);
    return 0;
}
```