```c
// Refactored code with clear comments
#include <stdio.h>
#include <unistd.h>
#include <sys/ioctl.h>
#include <sys/time.h>
#include <termios.h>
#include <time.h>

// External declarations
extern double constants[];

// Global variables
int window_width, window_height, cursor_x, cursor_y, random_seed, element_index = 0;

// Write a string to standard output
void write_output(char *str, long length) {
    write(1, str, length);
}

// Generate a pseudo-random number
unsigned char random_number() {
    random_seed ^= 8;
    return ++random_seed % 8;
}

// Get random byte from the constants array
int get_random_byte(int index) {
    return ((char *)&constants[index])[random_number()];
}

// Write 2-byte sequence from constants array
void write_2_bytes(int index) {
    write_output(((char *)(constants + 14)) + index * 2, 2);
}

// Write 3-byte sequence from constants array
void write_3_bytes(int index) {
    write_output(((char *)(constants + 16)) + index * 3, 3);
}

// Convert number to string representation
int convert_to_digit(int number, int position) {
    return number / (*((char *)(constants + 18) + position)) % 10 + 48;
}

// Initialize random seed using current time
void initialize_random_seed() {
    char buffer[16];
    gettimeofday((struct timeval *)buffer, 0L);
    random_seed = buffer[0];
}

// Get terminal window dimensions
void get_window_dimensions() {
    unsigned long window_size;
    ioctl(1, TIOCGWINSZ, &window_size);
    window_width = window_size & 65535;
    window_height = window_size >> 16 & 65535;
    cursor_x = window_height / 2 - 12;
    cursor_y = window_width - 4;
}

// Write escape sequence
void write_escape_sequence() {
    write_output("\033[", 2);
}

// Set text to bold
void set_text_bold() {
    write_escape_sequence();
    write_output("1m", 2);
}

// Reset text formatting
void reset_text_formatting() {
    write_escape_sequence();
    write_output("0m", 2);
}

// Save terminal screen, clear screen, and move cursor home
void save_and_clear_screen() {
    write_escape_sequence();
    write_output("?1049h", 6);
    write_escape_sequence();
    write_output("2J", 2);
    write_escape_sequence();
    write_output("H", 1);
}

// Move cursor to specified position
void move_cursor(int x, int y) {
    write_escape_sequence();
    write_output((char[]){convert_to_digit(x, 2), convert_to_digit(x, 1), convert_to_digit(x, 0)}, 3);
    write_output(";", 1);
    int temp = y;
    write_output((char[]){convert_to_digit(temp, 2), convert_to_digit(temp, 1), convert_to_digit(temp, 0)}, 3);
    write_output("H", 1);
}

// Set text color from constants
void set_text_color(int index) {
    write_escape_sequence();
    write_2_bytes(index);
    write_output("m", 1);
}

// Draw elements on the screen
void draw_elements() {
    for (int i = 0; i < 18; i++) {
        move_cursor(cursor_y + i / 6, cursor_x + (i % 6) * 4);
        set_text_color(((char *)&constants)[element_index++]);
        write_output(((char *)&constants) + (i << 2) + 24, 4);
    }
}

// Sleep for a short duration
void short_sleep() {
    char buffer[16] = {0};
    buffer[11] = 1;
    nanosleep((struct timespec *)buffer, 0L);
}

// Change text style based on conditions
void change_text_style(int index) {
    if (index < 3) index = 2;
    int styles[] = {3, 0, 1, 2, 0, 1};
    if (random_number() < 2) {
        set_text_bold();
        set_text_color(styles[index - 2]);
    } else {
        set_text_color(styles[index + 1]);
    }
}

// Calculate movement and color for element drawing
void calculate_movement_and_color(int type, int param, int x, int *y, int *z) {
    switch (type) {
        case 0:
            if (x <= 2 || param < 4) {
                *y = get_random_byte(12);
                *z = 0;
            } else if (x < 15) {
                *y = get_random_byte(12);
                *z = -(x % 2);
            } else {
                *y = get_random_byte(12);
                *z = get_random_byte(12) / 2;
            }
            break;
        case 3:
            *y = get_random_byte(12) * 1.5;
            *z = get_random_byte(13);
            break;
        case 4:
            *y = get_random_byte(12) / 2;
            *z = get_random_byte(12) / 2;
            break;
        default:
            *y = get_random_byte(13) * 1.5 * (1 - (type - 1) * 2);
            *z = get_random_byte(13) / 2;
            break;
    }
}

// Draw and animate elements on the screen
void animate_elements(int x, int y, int type, int height) {
    int movement_x, movement_y, color_change_counter = 5;
    while (height-- > 0) {
        int adjusted_height = 35 - height;
        calculate_movement_and_color(type, y, adjusted_height, &movement_x, &movement_y);
        if (movement_y > 0 && y > cursor_y - 2) movement_y--;
        if ((height < 3) || (x < 3 && height < 10)) animate_elements(x, y, 4, height);
        else if (x == 0 && height % 3 == 0) {
            if (color_change_counter <= 0) {
                color_change_counter = 3;
                animate_elements(x, y, (element_index++ % 2) + 1, height + 5);
            }
        }
        color_change_counter--;
        x += movement_x;
        y += movement_y;
        if (x < 0) x = 0;
        if (y < 0) y = 0;
        move_cursor(y, x);
        change_text_style(type);
        write_3_bytes(type);
        reset_text_formatting();
        short_sleep();
    }
}

// Constants used in the program
double constants[] = {
    2.5673396845218159e-289,
    2.5673475286552589e-289,
    5.0789948392480145e-321,
    4.4759385888332619e-091,
    2.2662500784516041e-085,
    6.0135556610268572e-154,
    6.0138114327429894e-154,
    6.0134700169990685e-154,
    6.0134703504179883e-154,
    2.5663272049433059e+151,
    2.5673651826636406e+151,
    6.0134700183229171e-154,
    5.3767695968532491e-299,
    7.2911289729117876e-304,
    6.1257806499948415e-062,
    4.6555645993480313e+025,
    6.5632629331317560e+299,
    7.9070799242303223e-101,
    3.2391739187041928e-317
};

// Main function
int main() {
    get_window_dimensions();
    initialize_random_seed();
    save_and_clear_screen();
    draw_elements();
    animate_elements(cursor_x + 10, cursor_y - 1, 0, 35);
    move_cursor(window_width, 0);
    return 0;
}
```