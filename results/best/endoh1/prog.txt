#include <stdio.h>

int main(void) {
    int i, j;

    #define G "#define "
    #define L p("#include __FILE__");
    #define p puts
    #define t printf

    #define define_macro(s, a) p(G #s " " #a);
    #define define_macro_with_args(s, a) p(G #s "(a,b) " #a);
    #define define_macro_with_three_args(s, x, y, z) p(G #s " " #x "," #y "," #z);
    #define if_macro(s) p("#if " #s);
    #define undef_macro(s) p("#undef " #s);
    #define else_macro p("#else")
    #define endif_macro p("#endif")

    #define process_macro(s) \
        define_macro(s##30, 0) \
        for (i = 31; --i; endif_macro) { \
            t("#if (" #s ")/%d&1\n", 1 << i); \
            t(G #s "%d " #s "%d|%d\n", i - 1, i, 1 << i); \
            else_macro; \
            t(G #s "%d " #s "%d\n", i - 1, i); \
        } \
        if_macro(s > 0); \
        undef_macro(s) \
        define_macro(s, (s##0)) \
        else_macro; \
        undef_macro(s) \
        define_macro(s, -(s##0)) \
        endif_macro;

    #define reset_macro(s) \
        undef_macro(s) \
        for (i = 31; i--;) \
            t("#undef " #s "%d\n", i);

    #define multi_define_macro(s) \
        define_macro(s##A, c(A, s)); process_macro(s##A); \
        define_macro(s##B, c(B, s)); process_macro(s##B); \
        define_macro(s##C, c(C, s)); process_macro(s##C); \
        undef_macro(s); define_macro_with_three_args(s, s##A, s##B, s##C);

    #define check_condition(d, m, e) \
        t("#if (c(%c,Z))/" #d "%%" #m "==%d\n", j, e)

    #define macro_loop(a, b) \
        for (i = 10; i--; endif_macro) { \
            check_condition(a, 10, i); \
            t(G b "\n", i); \
        }

    #define expand_macro(v, p, q, r) \
        define_macro_with_three_args(v(x, a, b), x(A(a), p(b)), x(B(a), q(b)), x(C(a), r(b)))

    #define complex_macro(x) \
        define_macro(i, N(o, t, h)) \
        define_macro(M, m(d(i, i))) \
        process_macro(M); \
        define_macro(j, d(g, O(U, i, M))) \
        if_macro(j < 0) \
        define_macro_with_three_args(x, 0, 0, 0) \
        else_macro; \
        define_macro(x, O(U, O(k, u, j), d(i, i))); \
        endif_macro; \
        multi_define_macro(x) \
        undef_macro(i) \
        reset_macro(M); \
        undef_macro(j) \
        endif_macro;

    define_macro_with_three_args(p, 0, 500, 4000)
    define_macro(q, 2000)
    define_macro_with_three_args(r, 300, 300, 300)
    define_macro_with_three_args(s(x), 900, 200 + x * 700, 900)
    define_macro_with_three_args(t, -2000, 4000, 1000)
    define_macro_with_three_args(u, 50000, 50000, 50000)
    define_macro_with_three_args(v(x), 500 - x, 500 - x, 500)

    if_macro(S)
    define_macro(V, N(o, P, p))
    define_macro(G, d(Q, Q))
    define_macro(f, d(V, Q))
    define_macro(Z, l(f) - k(G, (d(V, V) - l(q))))
    if_macro(Z > 0)
    define_macro(M, m(Z))
    process_macro(M);
    define_macro(R, U(-M - f, G))
    if_macro(R < 0)
    undef_macro(R)
    define_macro(R, U(M - f, G))
    if_macro(R < 0)
    undef_macro(R)
    endif_macro;
    endif_macro;
    endif_macro;
    if_macro(R)
    process_macro(R);
    reset_macro(M);
    define_macro(h, N(K, P, O(k, Q, R)))
    define_macro(g, O(U, N(o, h, p), q))
    complex_macro(D);
    reset_macro(M);
    undef_macro(V)
    undef_macro(G)
    undef_macro(f)
    undef_macro(Z)
    if_macro(R > 10)
    define_macro(F, N(K, O(k, g, 10), h))
    define_macro(I, N(o, Q, O(k, g, d(g, Q) * 2)))
    multi_define_macro(F);
    multi_define_macro(I);
    undef_macro(P)
    undef_macro(Q)
    define_macro(P, F)
    define_macro(Q, I)
    undef_macro(h)
    undef_macro(g)
    reset_macro(R);
    L
    undef_macro(V)
    define_macro(V, N(k, N(K, D, w), r))
    else_macro;
    undef_macro(h)
    undef_macro(g)
    reset_macro(R);
    if_macro(c(B, Q))
    define_macro(R, U(-2 * S - c(B, P), c(B, Q)))
    if_macro(R < 0 || 20000 < R)
    undef_macro(R)
    endif_macro;
    endif_macro;
    if_macro(R)
    process_macro(R);
    define_macro(h, N(K, P, O(k, Q, R)))
    define_macro_with_three_args(g, 0, S, 0)
    complex_macro(E);
    if_macro(R > 10)
    define_macro(w, N(k, O(k, E, l(c(A, h)) + l((c(C, h) - c(C, p))) < l(q) ? 100 : S), s((T(c(A, h)) == T(c(C, h))))))
    else_macro;
    define_macro(w, v(c(B, Q) / 2))
    endif_macro;
    multi_define_macro(w);
    define_macro(V, w)
    endif_macro;
    else_macro;
    define_macro(S, 1000)
    define_macro_with_args(K, (a + b))
    define_macro_with_args(o, (a - (b)))
    define_macro_with_args(k, ((a) * (b) / S))
    define_macro_with_args(U, ((a) * S / (b)))
    define_macro(l(a), k(a, a))
    define_macro_with_args(n, (b ? (U(a, b) + b) / 2 : 0))
    define_macro(m(x), n(x, n(x, n(x, n(x, n(x, n(x, (x) / 2))))))
    define_macro(T(x), (x > 0 ? x : S - x) / S % 2)
    define_macro_with_three_args(A(x, y, z), x)
    define_macro_with_three_args(B(x, y, z), y)
    define_macro_with_three_args(C(x, y, z), z)
    define_macro_with_args(c, a(b))
    define_macro_with_three_args(L(a, b), a(A(b)), a(B(b)), a(C(b)))
    expand_macro(N, A, B, C)
    expand_macro(O,,,)
    define_macro_with_args(d, (k(A(a), A(b)) + k(B(a), B(b)) + k(C(a), C(b))))
    define_macro_with_three_args(Q, (S * X / W * 2 - S), (S - S * Y / H * 2), S)
    define_macro_with_three_args(P, 0, 0, 0)
    L
    define_macro(e(x), m(x < 0 ? 0 : x > S ? S : x) * 255 / S)
    define_macro(Z, L(e, V))
    for (j = 64; j++ < 67;) {
        check_condition(100, 10, 0);
        define_macro(x(a), a)
        else_macro;
        macro_loop(100, "x(a) %d##a")
        endif_macro;
        check_condition(10, 100, 0);
        define_macro(y(a), a)
        else_macro;
        macro_loop(10, "y(a) x(%d##a)");
        endif_macro;
        macro_loop(1, "z y(%d)");
        p("z");
        undef_macro(z)
        undef_macro(y)
        undef_macro(x)
    }
    endif_macro;
}